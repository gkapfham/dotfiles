# vim: filetype=neomuttrc

# Source the mutt-wizard configuration that was automatically
# generated by the mutt-wizard and then modified manually
source ~/.config/mutt/mutt-wizard/mutt-wizard.muttrc

# Confirm that a signature should be displayed
set signature

# New mail is boldened:
color index brightyellow default "~N"
color index_author brightred default "~N"
color index_subject brightcyan default "~N"

# Color code key details about each email
color index yellow default '.*'
color index_author magenta default '.*'
color index_number cyan default
color index_subject blue default '.*'

# Other colors and aesthetic settings:
mono bold bold
mono underline underline
mono indicator underline
mono error bold
color normal default default
color indicator brightred default
color sidebar_highlight red default
color sidebar_divider brightblack default
color sidebar_flagged red default
color sidebar_new green default
color error red default
color tilde black default
color message cyan default
color markers red white
color attachment white default
color search brightmagenta default
color status brightblack default
color hdrdefault brightgreen default
color quoted green default
color quoted1 blue default
color quoted2 cyan default
color quoted3 yellow default
color quoted4 red default
color quoted5 brightred default
color signature brightgreen default
color bold black default
color underline black default

# Configuration for the main email account
source /home/gkapfham/.config/mutt/accounts/gkapfham@allegheny.edu.muttrc

# Switch to the main email account
macro index,pager i1 '<sync-mailbox><enter-command>source /home/gkapfham/.config/mutt/accounts/gkapfham@allegheny.edu.muttrc<enter><change-folder>!<enter>;<check-stats>' "switch to gkapfham@allegheny.edu"

# Confirm the use of the standard signature file
set signature                     = ~/.signature

# Keyboard Bindings {{{

# Use an aliases file to automatically save all of email addresses of emails that I read

# set alias_file = '~/.mutt/aliases.txt'
# source $alias_file

# Make it easy to switch to common Gmail folders
bind index g noop
bind index ga noop
bind index gj jump
macro index gi "<change-folder>=INBOX<enter>" "Go to inbox"

# Support navigation with respect to the current message like done in Vim
bind generic z  noop
bind generic zt current-top
bind generic zz current-middle
bind generic zb current-bottom

# Collapse current thread and collapse all of the threads
bind index za collapse-thread
bind index zA collapse-all

# Define keybindings for navigating to first and lass message
bind pager         g  noop
bind generic       gg first-entry
bind generic,index G  last-entry
bind pager         gg top
bind pager         G  bottom

# Define keybindings for navigating half up and down the page
bind generic,index,pager \Cd half-down
bind generic,index,pager \Cu half-up

# Make searching go in both directions
bind index n search-next
bind index p search-opposite

# Make it easy to navigate around threads
bind index { previous-thread
bind pager { half-up
bind index } next-thread
bind pager } half-down

# Define how to delete messages and threads
bind  index,pager d   noop
macro index,pager dd  "<delete-message>" "move message to trash"
macro index,pager dat "<delete-thread>"  "move thread to trash"

# Define how to undelete messages and threads
bind index,pager u noop
macro index,pager uu  "<undelete-message>" "undelete a message"
macro index,pager uat "<undelete-thread>" "undelete a thread"

# Define how to tag messages and threads
bind index,pager t noop
macro index,pager tt  "<tag-message>" "tag a message"
macro index,pager tat "<tag-thread>" "tag a thread"

# Confirm when appending messages to an existing mailbox?
set confirmappend=no

# Use "-" for a saved mailbox state and "*" for a changed mailbox state
# Use symbols that will only display correctly if using Nerd Fonts
set status_chars = "󰁦"

# Set the status line configuration for the bottom of the index and pager
# This configures and "Email Details" block on bottom left and "Mailbox Status" block on bottom right
set status_format = "[%f %m messages%?n? (%n new)?%?o? (%o old)?%?d? (%d to delete)?%?t? (%t tagged)?%?p? (%p postponed)?]%>─[ %r %S ]"

# Set the date format for display and in emails
# This data format is also adopted when a message is quoted
set date_format = "%m-%d-%Y %H:%M"

# Configure display for each email in index
set index_format = "%3C %Z%?X?A&? %D %-20.20F %s"

# Headers {{{

# Ignore all header entries and then only display some
ignore *
unignore from date subject to cc
unignore organization organisation x-mailer: x-newsreader: x-mailing-list:
unignore posted-to:

# Display entries in the email headers
my_hdr From: "Gregory M. Kapfhammer" <gkapfham@allegheny.edu>
my_hdr Bcc: "Gregory M. Kapfhammer" <gkapfham@gmail.com>
hdr_order From Date: From: To: Cc: Subject:

# Prefer plaintext over HTML email displays
alternative_order text/plain text/enriched text/html

# Automatically view HTML using a previewer in .mailcap
auto_view text/html text/enriched

# Enable header editing in Vim or Neovim
set edit_headers=yes

# }}}

# Sort the email so that new messages are on the top
# Reminder: sort_aux and second sort may lead to instability
set sort = threads
set sort_aux = reverse-last-date-received
set sort = reverse-date-received

# set use_threads=threads sort=last-date sort_aux=date
set use_threads=threads

# Further configure sorting of emails
set uncollapse_jump
set sort_re
set reply_regexp = "^(([Rr][Ee]?(\[[0-9]+\])?: *)?(\[[^]]+\] *)?)*"
set quote_regexp = "^( {0,4}[>|:#%]| {0,4}[a-z0-9]+[>|]+)+"

# Always use Unicode
set send_charset = "utf-8:iso-8859-1:us-ascii"
set charset = "utf-8"

# When prompted for a password uses a standard
# curses interface; may not actually be needed
setenv PINENTRY_USER_DATA curses
